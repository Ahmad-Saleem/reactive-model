"use strict";function ReactiveModel(){function e(e,n){if(c)throw new Error("model.addPublicProperty() is being invoked after model.finalize, but this is not allowed. Public properties may only be added before the model is finalized.");return r[e]=n,a[e]=n,i}function n(){if(c)throw new Error("model.finalize() is being invoked more than once, but this function should only be invoked once.");return c=!0,Object.keys(r).forEach(function(e){i[e]=function(n){return arguments.length?(a[e]=n,i):a[e]}}),i}function t(){var e={};return Object.keys(r).forEach(function(n){e[n]=a[n]}),e}function o(e){return Object.keys(r).forEach(function(e){var n=r[e];i[e](n)}),Object.keys(e).forEach(function(n){var t=e[n];i[n](t)}),i}if(!(this instanceof ReactiveModel))return new ReactiveModel;var i=this,r={},c=!1,a={};i.addPublicProperty=e,i.finalize=n,i.getState=t,i.setState=o}function Graph(){function e(e){return i[e]||(i[e]=[])}function n(n,t){e(n).push(t)}function t(n,t){i[n]&&(i[n]=i[n]),e(n).push(t)}function o(n,t){var o={},i=[];return t||(t=function(){return!0}),n.forEach(function r(n){!o[n]&&t(n)&&(o[n]=!0,e(n).forEach(r),i.push(n))}),i}var i={};return{adjacent:e,addEdge:n,removeEdge:t,DFS:o}}function ReactiveGraph(){function e(){return c++}function n(n,t){function o(n){var o=e();return a[o]=t[n],o}function i(n){var t=e();return u[t]=n,t}n.inNodes=n.inProperties.map(o),n.node=i(n),n.outNode=o(n.outProperty)}function t(e){if(void 0===e.inNodes||void 0===e.outNode)throw new Error("Attempting to add a reactive function that doesn't have inNodes or outNode defined first.");e.inNodes.forEach(function(n){r.addEdge(n,e.node)}),r.addEdge(e.node,e.outNode)}function o(e){var n=e.inNodes.map(function(e){return a[e]()}),t=e.callback.apply(null,n);a[e.outNode](t)}function i(){var e=Object.keys(d),n=r.DFS(e).reverse();n.forEach(function(e){e in u&&o(u[e])}),e.forEach(function(e){delete d[e]})}var r=new Graph,c=0,a={},u={},d={};return r.addReactiveFunction=t,r.assignNodes=n,r.makeNode=e,r.digest=i,r.changedPropertyNodes=d,r}function ReactiveFunction(e,n,t){return{inProperties:e,outProperty:n,callback:t,inNodes:void 0,outNode:void 0}}ReactiveFunction.parse=function(e){return Object.keys(e).map(function(n){var t=e[n],o=t.splice(t.length-1)[0],i=t;return ReactiveFunction(i,n,o)})},ReactiveModel.Graph=Graph,ReactiveModel.ReactiveGraph=ReactiveGraph,ReactiveModel.ReactiveFunction=ReactiveFunction;var reactiveModel=ReactiveModel;module.exports=reactiveModel;